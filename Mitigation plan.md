# Threat model diagram
![Threat_Model_Trekster](https://github.com/user-attachments/assets/4e986aef-9b0b-43d7-a2eb-6bb13a5d4ec6)

# Threat model table for the diagram above
|Id |Title                                                                                                                                  |Category               |Interaction|Priority|Description                                                                                                                             |Possible Mitigation(s)                                                                                                                                                                                                                                                                                                                                        |SDL Phase     |
|---|---------------------------------------------------------------------------------------------------------------------------------------|-----------------------|-----------|--------|----------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------|
|1  |An adversary may block access to the application or API hosted on Azure App Service Web App through a denial of service attack         |Denial of Service      |Request    |High    |An adversary may block access to the application or API hosted on Azure App Service Web App through a denial of service attack          |Network level denial of service mitigations are automatically enabled as part of the Azure platform (Basic Azure DDoS Protection). Implement application level throttling (e.g. per-user, per-session, per-API) to maintain service availability and protect against DoS attacks. Leverage Azure API Management for managing and protecting APIs.             |Implementation|
|2  |An adversary may gain long term persistent access to related resources through the compromise of an application identity               |Elevation of Privileges|Request    |High    |An adversary may gain long term persistent access to related resources through the compromise of an application identity                |Store secrets in secret storage solutions where possible, and rotate secrets on a regular cadence. Use Managed Service Identity to create a managed app identity on Azure Active Directory and use it to access AAD-protected resources.                                                                                                                      |Implementation|
|3  |An adversary may gain unauthorized access to Azure App Service Web App due to weak network configuration                               |Elevation of Privileges|Request    |High    |An adversary may gain unauthorized access to Azure App Service Web App due to weak network configuration                                |Restrict access to Azure App Service to selected networks (e.g. IP whitelisting, VNET integrations).                                                                                                                                                                                                                                                          |Implementation|
|4  |An adversary may perform action(s) on behalf of another user due to lack of controls against cross domain requests                     |Elevation of Privileges|Request    |High    |An adversary may perform action(s) on behalf of another user due to lack of controls against cross domain requests                      |Ensure that only trusted origins are allowed if CORS is being used.                                                                                                                                                                                                                                                                                           |Implementation|
|5  |An adversary may spoof the service or service endpoints by leveraging stale CNAME DNS records and executing a subdomain hijack attack  |Spoofing               |Response   |High    |An adversary may spoof the service or service endpoints by leveraging stale CNAME DNS records and executing a subdomain hijack attack   |Address stale CNAME DNS records mapping custom domain names to the domain name of the Azure Traffic Manager instance. In some cases, deleting the stale CNAME records may be sufficient, while in other cases, the domain name of the Azure Traffic Manager instance should be kept to prevent subdomain hijack attacks.                                      |Implementation|
|6  |An adversary can gain unauthorized access to Azure SQL database due to weak account policy                                             |Elevation of Privileges|SQL Query  |High    |Due to poorly configured account policies, adversary can launch brute force attacks on Azure SQL Database                               |When possible use Azure Active Directory Authentication for connecting to SQL Database. Ensure that least-privileged accounts are used to connect to Database server.                                                                                                                                                                                         |Implementation|
|7  |An adversary can gain unauthorized access to Azure SQL DB instances due to weak network security configuration.                        |Elevation of Privileges|SQL Query  |High    |An adversary can gain unauthorized access to Azure SQL DB instances due to weak network security configuration.                         |Restrict access to Azure SQL Database instances by configuring server-level and database-level firewall rules to permit connections from selected networks (e.g. a virtual network or a custom set of IP addresses) where possible.                                                                                                                           |Implementation|
|8  |An adversary can read confidential data due to weak connection string configuration                                                    |Information Disclosure |SQL Query  |High    |An adversary can read confidential data due to weak connection string configuration.                                                    |Clients connecting to an Azure SQL Database instance using a connection string should ensure encrypt=true and trustservercertificate=false are set. This configuration ensures that connections are encrypted only if there is a verifiable server certificate (otherwise the connection attempt fails). This helps protect against Man-In-The-Middle attacks.|Implementation|
|9  |An adversary having access to the storage container (e.g. physical access to the storage media) may be able to read sensitive data     |Information Disclosure |SQL Query  |High    |An adversary having access to the storage container (e.g. physical access to the storage media) may be able to read sensitive data.     |Enable Transparent Data Encryption (TDE) on Azure SQL Database instances to have data encrypted at rest. Use the Always Encrypted feature to allow client applications to encrypt sensitive data before it is sent to the Azure SQL Database.                                                                                                                 |Implementation|
|10 |A compromised identity may permit more privileges than intended to an adversary due to weak permission and role assignments            |Elevation of Privileges|SQL Query  |High    |A compromised identity may permit more privileges than intended to an adversary due to weak permission and role assignments.            |It is recommended to review permission and role assignments to ensure the users are granted the least privileges necessary.                                                                                                                                                                                                                                   |Implementation|
|11 |An adversary can deny actions performed on Azure SQL Database due to a lack of auditing                                                |Repudiation            |SQL Query  |Medium  |An adversary can deny actions performed on Azure SQL Database due to a lack of auditing.                                                |Enable auditing on Azure SQL Database instances to track and log database events. After configuring and customizing the audited events, enable threat detection to receive alerts on anomalous database activities indicating potential security threats.                                                                                                     |Design        |
|12 |An adversary can gain long term, persistent access to an Azure SQL DB instance through the compromise of local user account password(s)|Elevation of Privileges|SQL Query  |High    |An adversary can gain long term, persistent access to an Azure SQL DB instance through the compromise of local user account password(s).|It is recommended to rotate user account passwords (e.g. those used in connection strings) regularly, in accordance with your organization's policies. Store secrets in a secret storage solution (e.g. Azure Key Vault).                                                                                                                                     |Implementation|
|13 |An adversary may abuse weak Azure SQL Database configuration                                                                           |Elevation of Privileges|SQL Query  |High    |An adversary may abuse weak Azure SQL Database configuration.                                                                           |Enable SQL Vulnerability Assessment to gain visibility into the security posture of your Azure SQL Database instances. Acting on the assessment results help reduce attack surface and enhance your database security.                                                                                                                                        |Implementation|
